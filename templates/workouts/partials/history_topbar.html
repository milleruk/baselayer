<!-- Top bar: Sync + Type tabs -->
<div class="grid grid-cols-1 lg:grid-cols-12 gap-4 mb-6">

  <!-- Peloton / Sync card -->
  <div class="lg:col-span-5 rounded-2xl border border-gray-200 dark:border-gray-700 bg-white/80 dark:bg-gray-800/80 backdrop-blur shadow-sm">
    <div class="p-4 sm:p-5">
      <div class="flex items-start justify-between gap-4">
        <div class="min-w-0">
          {% include 'workouts/partials/sync_status.html' %}
          <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">
            Tip: sync after youâ€™ve cooled down (and stopped refreshing the page like a maniac ðŸ˜„)
          </p>
        </div>

        <div class="shrink-0">
          {% if peloton_connection %}
            <form method="post" action="{% url 'workouts:sync' %}" class="inline" id="sync-form">
              {% csrf_token %}
              <button
                type="submit"
                {% if not can_sync %}disabled{% endif %}
                class="group inline-flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-semibold text-white bg-primary hover:bg-primary-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-sm"
              >
                <svg class="h-4 w-4 opacity-90" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path d="M4 4a8 8 0 0113.657 4.047 1 1 0 01-1.96.4A6 6 0 005.14 6.1l-.644.643H7a1 1 0 110 2H2a1 1 0 01-1-1V3a1 1 0 112 0v1.586l.293-.293A7.98 7.98 0 014 4z"/>
                  <path d="M16 16a8 8 0 01-13.657-4.047 1 1 0 011.96-.4 6 6 0 0010.517 2.453l.644-.643H13a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-1.586l-.293.293A7.98 7.98 0 0116 16z"/>
                </svg>
                <span id="sync-btn-text">Sync</span>
                <svg id="sync-spinner" class="hidden animate-spin h-4 w-4 text-white" fill="none" viewBox="0 0 24 24" aria-hidden="true">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
              </button>
            </form>
          {% else %}
            <a href="{% url 'workouts:connect' %}"
               class="inline-flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-semibold text-white bg-primary hover:bg-primary-dark transition-colors shadow-sm">
              <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path d="M10 2a6 6 0 016 6v1a2 2 0 012 2v1a2 2 0 01-2 2h-1.5a.5.5 0 01-.5-.5V9a.5.5 0 01.5-.5H16V8a6 6 0 10-12 0v.5h1.5A.5.5 0 016 9v4.5a.5.5 0 01-.5.5H4a2 2 0 01-2-2v-1a2 2 0 012-2V8a6 6 0 016-6z"/>
              </svg>
              Connect Peloton
            </a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- Workout Type Tabs -->
  <div class="lg:col-span-7 rounded-2xl border border-gray-200 dark:border-gray-700 bg-white/80 dark:bg-gray-800/80 backdrop-blur shadow-sm">
    <div class="p-3 sm:p-4">
      <div class="flex items-center justify-between gap-3 mb-2">
        <div class="text-sm font-semibold text-gray-900 dark:text-white">Types</div>
        <div class="text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap">
          {% if workout_type_filter %}Filtered{% else %}All workouts{% endif %}
        </div>
      </div>

      <div class="flex gap-2 overflow-x-auto no-scrollbar py-1">
        <a
          href="{% url 'workouts:history' %}{% if qs_without_type_and_page %}?{{ qs_without_type_and_page }}{% endif %}"
          class="px-4 py-2 rounded-full text-sm font-semibold border transition-colors whitespace-nowrap
            {% if not workout_type_filter %}
              bg-primary/10 text-primary border-primary/30
            {% else %}
              bg-transparent text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/40
            {% endif %}"
        >All</a>

        {% for workout_type in workout_types %}
          <a
            href="{% url 'workouts:history' %}?type={{ workout_type.slug }}{% if qs_without_type_and_page %}&{{ qs_without_type_and_page }}{% endif %}"
            class="px-4 py-2 rounded-full text-sm font-semibold border transition-colors whitespace-nowrap
              {% if workout_type_filter == workout_type.slug %}
                bg-primary/10 text-primary border-primary/30
              {% else %}
                bg-transparent text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/40
              {% endif %}"
          >{{ workout_type.name }}</a>
        {% endfor %}
      </div>
    </div>
  </div>
</div>