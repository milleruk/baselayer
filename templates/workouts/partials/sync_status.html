<div
  {% if sync_in_progress %}
    hx-get="{% url 'workouts:sync_status' %}"
    hx-trigger="every 5s"
    hx-swap="outerHTML"
  {% endif %}
  id="sync-status-container"
  class="flex items-start gap-3 flex-1 min-w-0"
>
  {# Status dot #}
  <div class="mt-1.5 h-2.5 w-2.5 rounded-full
    {% if sync_in_progress %}
      bg-yellow-500 animate-pulse
    {% elif peloton_connection and peloton_connection.is_connected %}
      bg-green-500
    {% else %}
      bg-gray-400
    {% endif %}
  "></div>

  <div class="flex-1 min-w-0">
    {# Title row: title + status pill #}
    <div class="flex flex-wrap items-center gap-2">
      {% if sync_in_progress %}
        <div class="font-semibold text-gray-900 dark:text-white">Syncing</div>
        <span class="inline-flex items-center gap-1.5 rounded-full px-2.5 py-1 text-xs font-semibold border border-yellow-200 dark:border-yellow-900/40 bg-yellow-50 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-300">
          <svg class="h-3.5 w-3.5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
          </svg>
          In progress
        </span>

      {% elif sync_cooldown_until %}
        <div class="font-semibold text-gray-900 dark:text-white">Connected</div>
        <span class="inline-flex items-center gap-1.5 rounded-full px-2.5 py-1 text-xs font-semibold border border-orange-200 dark:border-orange-900/40 bg-orange-50 dark:bg-orange-900/20 text-orange-800 dark:text-orange-300">
          <svg class="h-3.5 w-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          Cooldown
        </span>

      {% elif peloton_connection and peloton_connection.is_connected %}
        <div class="font-semibold text-gray-900 dark:text-white">Connected</div>
        <span class="inline-flex items-center gap-1.5 rounded-full px-2.5 py-1 text-xs font-semibold border border-green-200 dark:border-green-900/40 bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300">
          <svg class="h-3.5 w-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          Ready
        </span>

      {% else %}
        <div class="font-semibold text-gray-900 dark:text-white">Not connected</div>
        <span class="inline-flex items-center gap-1.5 rounded-full px-2.5 py-1 text-xs font-semibold border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/30 text-gray-700 dark:text-gray-300">
          Setup required
        </span>
      {% endif %}
    </div>

    {# Body copy (short, consistent) #}
    {% if sync_in_progress %}
      <div class="mt-1 text-sm text-gray-600 dark:text-gray-400">
        Workouts are syncing now — this panel refreshes automatically.
      </div>

    {% elif sync_cooldown_until %}
      <div class="mt-1 text-sm text-gray-600 dark:text-gray-400">
        Connected. Sync again in <span class="font-semibold text-gray-900 dark:text-white">{{ cooldown_remaining_minutes }}</span> minute{{ cooldown_remaining_minutes|pluralize }}.
      </div>

    {% elif peloton_connection and peloton_connection.last_sync_at %}
      <div class="mt-1 text-sm text-gray-600 dark:text-gray-400">
        Last sync: <span class="font-semibold text-gray-900 dark:text-white">{{ peloton_connection.last_sync_at|date:"M d, Y g:i A" }}</span>
        <span class="mx-1 text-gray-400">•</span>
        Next sync will be incremental.
      </div>

    {% elif peloton_connection and peloton_connection.is_connected %}
      <div class="mt-1 text-sm text-gray-600 dark:text-gray-400">
        Click Sync to import your workouts{% if not peloton_connection.last_sync_at %} (first sync pulls full history){% endif %}.
      </div>

    {% else %}
      <div class="mt-1 text-sm text-gray-600 dark:text-gray-400">
        Connect your Peloton account to sync your workout history.
      </div>
    {% endif %}
  </div>
</div>
