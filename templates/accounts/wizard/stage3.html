{% extends "accounts/wizard/base.html" %}

{% block title %}Stage 3: Select Your Sports | Chase The Zones{% endblock %}

{% block content %}
<div>
  <div class="mb-4">
    <a href="{% url 'wizard_stage_2' %}" class="inline-flex items-center text-sm text-gray-500 transition-colors hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300">
      <svg class="stroke-current mr-2" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none">
        <path d="M12.7083 5L7.5 10.2083L12.7083 15.4167" stroke="" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
      Back to Peloton
    </a>
  </div>

  <div class="mb-8">
    <h1 class="mb-2 font-semibold text-gray-800 text-title-sm dark:text-white/90 sm:text-title-md">
      What Do You Do?
    </h1>
    <p class="text-sm text-gray-500 dark:text-gray-400">
      Select the activities you participate in. You can choose one, two, or all three!
    </p>
  </div>

  <form method="post" class="space-y-4">
    {% csrf_token %}
    
    <div class="space-y-3">
      {% for value, label in form.sports.field.choices %}
        <label class="flex items-center p-4 border-2 border-gray-200 dark:border-gray-700 rounded-lg hover:border-primary/30 dark:hover:border-primary/30 cursor-pointer transition-colors group">
          <input
            type="checkbox"
            name="sports"
            value="{{ value }}"
            class="w-5 h-5 rounded text-primary bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-600 focus:ring-primary"
            {% if value in form.sports.value %}checked{% endif %}
          />
          <div class="ml-4 flex-1">
            <span class="font-medium text-gray-900 dark:text-white group-hover:text-primary transition-colors">
              {% if value == "cycling" %}
                üö¥ Cycling
              {% elif value == "running" %}
                üèÉ Running
              {% elif value == "walking" %}
                üö∂ Walking
              {% else %}
                {{ label }}
              {% endif %}
            </span>
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
              {% if value == "cycling" %}
                Power Zone training, FTP tests, and performance metrics
              {% elif value == "running" %}
                Pace zone training and running performance tracking
              {% elif value == "walking" %}
                Walking pace zones and endurance building
              {% endif %}
            </p>
          </div>
        </label>
      {% endfor %}
    </div>

    {% if form.sports.errors %}
      <p class="text-sm text-red-600 dark:text-red-400">{{ form.sports.errors.0 }}</p>
    {% endif %}

    <!-- Submit Button -->
    <div class="pt-4">
      <button
        type="submit"
        class="w-full h-11 rounded-lg bg-primary text-white font-medium transition-colors hover:bg-primary/90 active:bg-primary/80 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        Continue to Next Step
      </button>
    </div>
  </form>

  <!-- Help Text -->
  <p class="mt-6 text-center text-xs text-gray-500 dark:text-gray-400">
    You can change these selections anytime in your profile settings.
  </p>

  <script>
    // Require at least one checkbox to be checked
    const form = document.querySelector('form');
    const checkboxes = document.querySelectorAll('input[name="sports"]');
    const submitBtn = form.querySelector('button[type="submit"]');
    
    function updateSubmitButton() {
      const isAnyChecked = Array.from(checkboxes).some(cb => cb.checked);
      submitBtn.disabled = !isAnyChecked;
    }
    
    checkboxes.forEach(checkbox => {
      checkbox.addEventListener('change', updateSubmitButton);
    });
    
    updateSubmitButton();
  </script>
</div>
{% endblock %}
